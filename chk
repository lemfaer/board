#!/usr/bin/php7.1
<?php

require __DIR__ . "/inc/autoload.php";
require __DIR__ . "/src/autoload.php";
require __DIR__ . "/test/autoload.php";

if (intval(ini_get("zend.assertions")) < 1) {
	print("zend.assertions isn't set to 1, please check php.ini\n");
	die;
}

ini_set("assert.active", 1);
ini_set("assert.exception", 1);

$tests = [
	\Board\Test\Container\Test::class => [
		"test_get_object", "test_get_object_dep", "test_get_object_same", "test_get_value"
	],
	\Board\Test\Router\Test::class => [
		"test_dispatch_method", "test_dispatch_uri", "test_dispatch_uri_params"
	],
	\Board\Test\View\Test::class => [
		"test_view", "test_view_params"
	],
	\Board\Test\Session\Test::class => [
		"test_array_set", "test_array_set_key", "test_array_isset", "test_array_unset",
		"test_iterator", "test_count"
	],
	\Board\Test\Message\Test::class => [
		"test_message", "test_pop_all", "test_flush"
	]
];

foreach ($tests as $cls => $meths) {
	$obj = new $cls();

	foreach ($meths as $meth) {
		call_user_func([ $obj, $meth ]);
		print("$cls $meth passed\n");
	}
}

print("all tests passed\n");
